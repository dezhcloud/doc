# ویرایش رکوردهای DNS

هنگامی که یک رکورد به فهرست رکوردهای DNS اضافه شود، یک گزینه‌ی ویرایش در انتها قابل مشاهده است که شما می‌توانید با کلیک روی آن، تنظیمات رکورد مربوطه را تغییر دهید. به جز رکوردهای NS که توسط دژ برای دامنه شما ارایه می‌شوند، تمام رکوردها قابلیت ویرایش دارند.

## ویرایش رکورد A

برای رکوردهایی از نوع A،ویرایش دامنه شامل گزینه‌های بیش‌تری در مقایسه با سایر انواع رکورد‌ها است.

<p align="center"><img src="/doc/assets/img/dns_records_edit/edita.png"></p>

این گزینه‌ها عبارتند از:

- وضعیت ابر: با فعال و غیر فعال‌سازی این گزینه می‌توانید عبور ترافیک را از روی CDN ابر دژ کنترل کنید. با فعال‌سازی آن، ترافیک از روی سرورهای ابر دژ عبور می‌کنند و شتاب‌دهی و ایمن می‌شوند.

- عنوان: در این قسمت می‌توان عنوان رکورد را تغییر داد. این عنوان برای رکورد A، برابر است با نام زیر دامنه‌ی دامنه اصلی.

مدت‌ زمان اعتبار: مدت زمان اعتبار، همان TTL رکورد است. اگر نماد ابر روشن باشد، این مقدار به‌شکل خودکار به‌وسیله‌ی ابر دژ تنظیم می‌شود و قابل تغییر از سمت صاحب دامنه نیست.

- نشانی IP: مقادیر آدرس‌های IP هستند که به سرورهای اصلی دامنه اشاره دارند. اگر برای یک رکورد A در این بخش، بیش از یک آدرس تعریف شود، در قسمت انتهایی قابلیت لود بالانس برای دامنه فعال می‌شود که در ادامه قابل مشاهده است.

<p align="center"><img src="/doc/assets/img/dns_records_edit/edit2.png"></p>

- نوع پاسخ: در این بخش می‌توان نوع پاسخ را تکی/چندتایی تعیین کرد. این بخش مشخص‌کننده‌ی آن است که در پاسخ به هر درخواست DNS، تنها یکی از رکوردها به عنوان پاسخ برای درخواست‌کننده ارسال شود یا همه‌ی‌ آن‌ها.

- توزیع بار: در این بخش نوع توزیع بار را می‌توان یکی از گزینه‌های خاموش/نوبتی/نوبتی با وزن تعیین کرد. اگر گزینه‌ی خاموش استفاده شود، همواره ترتیب ارسال پاسخ برای کاربر بدون تغییر باقی می‌ماند. یعنی اگر نوع پاسخ در بخش قبل، تکی مشخص شده باشد، تنها اولین رکورد و اگر نوع پاسخ چندتایی مشخص شده باشد، با همان ترتیب اولیه و بدون تغییر به کاربر پاسخ داده می‌شود.

اگر گزینه‌ی نوبتی انتخاب شود، رکوردهای DNS به‌شکل نوبتی و با توزیع یکسان برای درخواست دهنده‌ها ارسال می‌شوند. برای نمونه، در حالتی که در شکل بالا نشان داده شده است، اگر توزیع بار نوبتی باشد و نوع پاسخ هم تکی مشخص شده باشد، برای درخواست‌دهنده‌ی اول IP:192.168.1.1 ارسال می‌شود و برای درخواست‌دهنده‌ی دوم IP:192.168.1.2.

اگر گزینه‌ی نوبتی با وزن انتخاب شود، ستونی به اسم وزن در کنار نشانی IP ایجاد می‌شود که مشخص ‌کننده‌ی وزن IP مربوطه در توزیع بار است.

<p align="center"><img src="/doc/assets/img/dns_records_edit/weight.png"></p>

برای نمونه، اگر مشابه تصویر بالا وزن یکی از رکوردها ۱ و وزن دیگری ۱۰۰ باشد، از هر ۱۰۱ درخواست، یکی پاسخ IP اول را دریافت می‌کند و ۱۰۰ درخواست دیگر IP دوم را.

- موقعیت جغرافیایی: در این بخش می‌توان یکی از گزینه‌های خاموش/خودکار/کشور را مشخص کرد. اگر می‌خواهید ترافیکی که از کشور خاصی به سمت دامنه‌ی شما ارسال می‌شود را به سمت سروری مشخص ارسال کنید، می‌توانید از این گزینه استفاده کنید. با انتخاب گزینه‌ی کشور، در کنار IP ستونی اضافه می‌شود و می‌توانید کشوری را که تمایل دارید ترافیک آن به سمت IP مورد نظر هدایت شود را انتخاب کنید.

اگر در این قسمت تنظیمات نماد ابر را روشن کنید، قسمت پروتکل فعال می‌شود و قسمت‌های توزیع بار و هم‌چنین مدت اعتبار غیر فعال می‌شوند.

در این حالت ترافیک به سمت سرورهای CDN ارسال می‌شود و IPهای وارد شده به کاربر نشان داده نمی‌شوند.



<p align="center"><img src="/doc/assets/img/dns_records_edit/cloud.png"></p>

در این حالت با انتخاب وزن مناسب می‌توانید توزیع بار را برای ترافیک لایه‌ی 7 شبکه (HTTP/HTTPS) میان سرورهای خود انجام دهید. نوع پروتکل ارتباطی با سرور اصلی را نیز می‌توانید در قسمت پروتکل تعیین کنید.

- پروتکل: در این بخش می‌توان یکی از گزینه‌های Default/Automatic/HTTP/HTTPS را انتخاب کرد. با انتخاب گزینه‌ی Default، تنظیمات پنل CDN روی نوع پروتکل ارتباطی با سرور اصلی، برای این رکورد نیز اعمال می‌شود.

با انتخاب گزینه‌ی Automatic،درخواست‌ها به همان شکلی که به دست سرورهای CDN ابر دژ برسند، برای سرور اصلی میزبان سایت نیز ارسال می‌شوند. اگر درخواست HTTP یا HTTPS باشد، بدون تغییر پروتکل (TLS) به سمت سرور اصلی ارسال می‌شود.

با انتخاب گزینه‌ی HTTP اجبار می‌شود که برای ارتباط با سرور اصلی از پروتکل HTTP (بدون رمزنگاری) استفاده شود. هم‌چنین، با انتخاب گزینه‌ی HTTPS اجبار می‌شود که برای ارتباط با سرور اصلی از پروتکل HTTPS (همراه با رمزنگاری) استفاده شود. با انتخاب گزینه‌ی HTTP/HTTPS، می‌توان پورت سرور که درخواست‌ها برای آن ارسال می‌شوند را نیز انتخاب کرد. در این حالت، ستونی در کنار IP هر سرور اضافه می‌شود که امکان تنظیم port را به شما می‌دهد.

- پورت:‌ با فعال‌سازی CDN ابر دژ ارتباط کاربر نهایی با سرور لبه‌ ابر دژ تنها روی پورت‌های خاصی برقرار می‌شود که این پورت‌ها به شرح زیر هستند:

| HTTPS     | HTTP      |
| --------- | --------- |
| `443`     | 8080      |
| `2053`    | 8880      |
| `2083`    | 2052      |
| `2087`    | 2082      |
| `2096`    | 2086      |
| `8443`    | 2095      |

اما ارتباط میان سرورهای لبه ابر دژ با سرور اصلی میزبان سایت شما می‌تواند بر بستر HTTP یا HTTPS و روی هر پورتی برقرار شود.

برای نمونه تصور کنید قصد دارید به cPanel روی پورت 2082 متصل شوید. برای انجام این کار باید در مرورگر خود آدرس را به‌شکل cpanel.example.com:2082 وارد کنید. اگر CDN برای رکورد cPanel فعال شده باشد و شماره پورتی که در انتهای آدرس بیان شده، برای این رکورد در بخش مربوط به آن مشخص نشده باشد، شما به cPanel خود متصل نمی‌شوید؛ چرا که به‌شکل پیش‌‍فرض ارتباط میان سرور لبه ابر دژ و سرور اصلی میزبان سایت شما هم‌چنان روی پورت 80 یا 443 برقرار می‌شود.

اما با تنظیم شماره پورت مورد نظر، تنها کافی است در مرورگر همان آدرس cpanel.examle.com را وارد کنید. به‌شکل خودکار ارتباط میان سرور لبه ابر دژ با سرور اصلی میزبان سایت شما روی پورت 2082 برقرار می‌شود. این در حالی است که نیازی به غیرفعال‌ کردن CDN برای رکورد مربوطه نیز نیست.

شماره پورت چند سرویس رایج به شکل زیر است:

| شماره پورت        | سرویس        |
| ------------- | ------------- |
| `2082`        | cPanel        |
| `2086`        | WHM           |
| `8085`        | Webmail       |

<p align="center"><img src="/doc/assets/img/dns_records_edit/protocol.png"></p>

## حذف رکوردهای DNS

اگر بنا به هر دلیلی قصد دارید تا یکی از رکوردهای دامنه‌ی خود را حذف کنید، در پنل کاربری ابر دژ به محصول CDN، بخش «رکوردهای DNS» بروید و روی آیکون حذف روبه‌روی رکورد موردنظر خود کلیک کنید.

<p align="center"><img src="/doc/assets/img/dns_records_edit/delete.png"></p>

سپس با کلیک روی گزینه‌ی حذف، رکورد مورد نظر حذف خواهد شد.

<p align="center"><img src="/doc/assets/img/dns_records_edit/deleteconfirm.png"></p>
