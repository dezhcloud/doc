# In Flight Request

محدود کردن تعداد درخواست‌های همزمان در حال پردازش

<p align="center"><img src="/doc/assets/img/middlewares/inflightreq.png"></p>

برای جلوگیری از غرق شدن سرویس‌ها با بار زیاد، تعداد درخواست‌های مجاز همزمان در حال پردازش می‌تواند محدود شود.

## Amount

گزینه "مقدار" حداکثر مقدار مجاز درخواست همزمان در حال پردازش را تعیین می کند. اگر قبلاً درخواست‌های مقدار در حال انجام باشد (بر اساس همان استراتژی sourceCriterion) میان‌افزار با درخواست‌های خیلی زیاد `HTTP 429` پاسخ می‌دهد.

## IP Strategy

این گزینه مشخص می کند که چه معیاری برای گروه بندی درخواست ها به عنوان منبع مشترک استفاده می شود. اگر چندین استراتژی به طور همزمان تعریف شود، یک خطا مطرح می شود. اگر هیچ یک تنظیم نشده باشد، پیش فرض استفاده از فیلد آدرس راه دور درخواست (به عنوان یک استراتژی ip) است. دو پارامتر را تعریف می کند که تعیین می کند CDN چگونه IP مشتری را تعیین می کند: عمق و `excluded IPs`. اگر استراتژی تنظیم نشده باشد، رفتار پیش‌فرض مطابقت با `source Range` با آدرس از راه دور موجود در درخواست است. .

### Depth

گزینه عمق برای استفاده از هدر `X-Forwarded-For` و گرفتن IP واقع در موقعیت عمق (از سمت راست شروع می شود). اگر عمق از تعداد کل IP ها در `X-Forwarded-For` بیشتر باشد، IP کلاینت خالی خواهد بود. اگر مقدار آن کمتر یا مساوی `0` باشد، عمق نادیده گرفته می شود.

### Excluded IPs

`excluded IPs` دژ را برای اسکن هدر `X-Forwarded-For` پیکربندی می کند و اولین IP را که در لیست نیست انتخاب می کند.

### Request Header Name

نام هدر مورد استفاده برای گروه بندی درخواست های دریافتی.

### Request Host

آیا `Request Host` به عنوان منبع در نظر گرفته شود.
