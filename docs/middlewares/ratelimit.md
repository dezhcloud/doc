# Rate Limit

میان‌افزار RateLimit تضمین می‌کند که سرویس‌ها مقدار مناسبی از درخواست‌ها را دریافت می‌کنند و به فرد اجازه می‌دهد تعریف کند که منصفانه چیست.

<p align="cemter"><img src="/doc/assets/img/ratelimit.png"></p>

## Average

میانگین حداکثر نرخی است که به طور پیش‌فرض در درخواست‌ها در ثانیه مجاز است از یک منبع مشخص. به طور پیش فرض روی 0 قرار می گیرد، که به معنای عدم محدودیت نرخ است. نرخ در واقع با تقسیم میانگین بر دوره تعریف می شود. بنابراین برای نرخ زیر 1 req/s، باید دوره ای بزرگتر از یک ثانیه تعریف کرد.

## Period

دوره، در ترکیب با میانگین، حداکثر نرخ واقعی را تعریف می کند، مانند: "r = میانگین / دوره" به طور پیش فرض 1 ثانیه است.

## Burst

burst حداکثر تعداد درخواست‌هایی است که مجاز به انجام آن در همان بازه زمانی کوتاه خودسرانه هستند. پیش فرض آن 1 است.

## IP Strategy

این گزینه مشخص می کند که چه معیاری برای گروه بندی درخواست ها به عنوان منبع مشترک استفاده می شود. اگر چندین استراتژی به طور همزمان تعریف شود، یک خطا مطرح می شود. اگر هیچ یک تنظیم نشده باشد، پیش فرض استفاده از فیلد آدرس راه دور درخواست (به عنوان یک استراتژی ip) است. دو پارامتر را تعریف می کند که تعیین می کند CDN چگونه IP مشتری را تعیین می کند: عمق و `excluded IPs`. اگر استراتژی تنظیم نشده باشد، رفتار پیش‌فرض مطابقت با `source Range` با آدرس از راه دور موجود در درخواست است. .

### Depth

گزینه عمق برای استفاده از هدر `X-Forwarded-For` و گرفتن IP واقع در موقعیت عمق (از سمت راست شروع می شود). اگر عمق از تعداد کل IP ها در `X-Forwarded-For` بیشتر باشد، IP کلاینت خالی خواهد بود. اگر مقدار آن کمتر یا مساوی `0` باشد، عمق نادیده گرفته می شود.

### Excluded IPs

`excluded IPs` دژ را برای اسکن هدر `X-Forwarded-For` پیکربندی می کند و اولین IP را که در لیست نیست انتخاب می کند.

### Request Header Name

نام هدر مورد استفاده برای گروه بندی درخواست های دریافتی.

### Request Host

آیا `Request Host` به عنوان منبع در نظر گرفته شود.